var e,t,i,n,a,s=function(e,t,i,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,i):a?a.value=i:t.set(e,i),i},r=function(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)};class o extends HTMLElement{constructor(){super(),this.productId="",this.cid="",this.windowMode="popup",this.theme="auto",this.size="large",this.language="",e.set(this,o.englishLanguage),t.set(this,"prod"),i.set(this,"dev"===r(this,t,"f")?"iframe.html":"https://get.microsoft.com/iframe.html"),n.set(this,"dev"===r(this,t,"f")?"/images":"https://getbadgecdn.azureedge.net/images"),a.set(this,{isWindows:!1,windowsVersion:null,isEdgeBrowser:!1}),this.getPlatformDetails().then((e=>s(this,a,e,"f"))),s(this,e,o.getSupportedLanguageFromCode(this.language),"f"),this.language=r(this,e,"f").code;const h=this.attachShadow({mode:"open"}),l=this.createStyle(),d=this.createHtml();h.appendChild(l),h.appendChild(d)}updateImageSrc(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("img");t&&(t.setAttribute("src",this.getImageSource()),t.className=this.getImageClass())}connectedCallback(){}static get observedAttributes(){return["productid","cid","windowmode","theme","size","language"]}attributeChangedCallback(t,i,n){"size"!==t||"large"!==n&&"small"!==n||i===n?"language"!==t||n===i||"string"!=typeof n&&n?"productid"===t&&n!==i&&"string"==typeof n?this.productId=n:"cid"===t&&n!==i&&"string"==typeof n?this.cid=n:"windowmode"!==t||"popup"!==n&&"full"!==n||i===n?"theme"!==t||"dark"!=n&&"light"!==n&&"auto"!==n||i===n||(this.theme=n,this.updateImageSrc()):(this.windowMode=n,this.updateImageSrc()):(s(this,e,o.getSupportedLanguageFromCode(n),"f"),this.language=r(this,e,"f").code,this.updateImageSrc()):(this.size=n,this.updateImageSrc())}createStyle(){const e=document.createElement("style");return e.textContent="\n      :host {\n        display: inline-block;\n        cursor: pointer;\n        height: fit-content;\n      }\n\n      iframe {\n        border: none;\n        width: 0px;\n        height: 0px;\n      }\n\n      img {\n        width: auto;\n        border-radius: 8px;\n      }\n\n      img:hover {\n      transform: translate(0, -4px);\n        cursor: pointer;\n        box-shadow: 0 12px 40px 2px rgba(0, 0, 0, 0.05);\n        transition: 0.35s ease;\n      }\n      \n      img.small {\n        max-height: 52px;\n      }\n\n      img.large {\n        max-height: 104px;\n      }\n      \n\n    ",e}createHtml(){const e=document.createElement("div");return e.appendChild(this.createImage()),e.appendChild(this.createIFrame()),e}async getPlatformDetails(){const e=navigator;if(e.userAgentData&&e.userAgentData.getHighEntropyValues)try{const t=await e.userAgentData.getHighEntropyValues(["platform","platformVersion"]),i="Windows"===t.platform;return{isWindows:i,windowsVersion:i?parseFloat((null==t?void 0:t.platformVersion)||""):null,isEdgeBrowser:(e.userAgentData.brands||[]).some((e=>"Microsoft Edge"===e.brand))}}catch(e){}const t=new RegExp(/.?Windows NT (\d+\.?\d?\.?\d?\.?\d?)/gi).exec(navigator.userAgent);return t&&t.length>=2?{isWindows:!0,windowsVersion:parseFloat(t[1]),isEdgeBrowser:!!navigator.userAgent.match("Edg/")}:{isWindows:!1,windowsVersion:null,isEdgeBrowser:!!navigator.userAgent.match("Edg/")}}static getSupportedLanguageFromCode(e){if(!e)return o.getSupportedLanguageFromUserAgent();const t=o.supportedLanguages.find((t=>t.code===e.toLowerCase()));return t||o.englishLanguage}static getSupportedLanguageFromUserAgent(){const e=o.supportedLanguages.find((e=>e.name===navigator.language));if(e)return e;if(navigator.languages){var t=navigator.languages.map((e=>o.supportedLanguages.find((t=>t.code===e)))).find((e=>!!e));if(t)return t}const i=navigator.language.indexOf("-");if(i>0){const e=navigator.language.substring(0,i),t=o.supportedLanguages.find((t=>t.name===e));if(t)return t}return o.englishLanguage}createIFrame(){const e=document.createElement("iframe");return e.setAttribute("loading","eager"),e.title="Microsoft Store App Badge",e.src=r(this,i,"f"),e}createImage(){const e=document.createElement("img");return e.setAttribute("part","img"),e.src=this.getImageSource(),e.className=this.getImageClass(),e.alt="Microsoft Store app badge",e.addEventListener("click",(e=>this.launchApp(e))),e}getImageSource(){var t=null;if("dark"===this.theme)t="large"===this.size?r(this,e,"f").imageLarge.fileName:r(this,e,"f").imageSmall.fileName;else if("light"===this.theme)t="large"===this.size?r(this,e,"f").imageLargeLight.fileName:r(this,e,"f").imageSmallLight.fileName;else if("auto"===this.theme){t=window.matchMedia("(prefers-color-scheme:dark)").matches?"large"===this.size?r(this,e,"f").imageLargeLight.fileName:r(this,e,"f").imageSmallLight.fileName:"large"===this.size?r(this,e,"f").imageLarge.fileName:r(this,e,"f").imageSmall.fileName}return`${r(this,n,"f")}/${t}`}getImageClass(){return"large"===this.size?"large":"small"}launchApp(e){this.productId&&(r(this,a,"f").isWindows&&r(this,a,"f").isEdgeBrowser?this.launchStoreAppPdpViaWhitelistedDomain():r(this,a,"f").isWindows?this.launchStoreAppPdp():this.launchStoreWebPdp(e))}launchStoreAppPdp(){const e="ms-windows-store://pdp/?productid="+this.productId+(this.cid?"&cid="+encodeURIComponent(this.cid):"")+"&referrer=appbadge&source="+encodeURIComponent(window.location.host)+("popup"===this.windowMode?"&mode=mini&pos=":"&pos=")+Math.floor(window.screenLeft*window.devicePixelRatio)+","+Math.floor(window.screenTop*window.devicePixelRatio)+","+Math.floor(window.outerWidth*window.devicePixelRatio)+","+Math.floor(window.outerHeight*window.devicePixelRatio);location.href=e}launchStoreAppPdpViaWhitelistedDomain(){var e,t;if("full"===this.windowMode)this.launchStoreAppPdp();else{const i=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("iframe");if(i){const e={message:"launch",productId:this.productId};null===(t=i.contentWindow)||void 0===t||t.postMessage(e,"*")}}}launchStoreWebPdp(e){var t="";t=this.cid?`https://apps.microsoft.com/store/detail/${this.productId}?cid=${encodeURIComponent(this.cid)}&referrer=appbadge&source=${encodeURIComponent(window.location.host)}`:`https://apps.microsoft.com/store/detail/${this.productId}?referrer=appbadge&source=${encodeURIComponent(window.location.host)}`,e.ctrlKey?window.open(t,"_blank"):window.location.href=t}static createSupportedLanguages(){let e=new Map;e.set("Arabic","ar"),e.set("Belarusian","be"),e.set("Bengali","bn"),e.set("Bosnian","bs"),e.set("Bulgarian","bg"),e.set("Chinese_Simplified","zh-cn"),e.set("Chinese_Traditional","zh-tw"),e.set("Croatian","hr"),e.set("Czech","cs"),e.set("Danish","da"),e.set("Dutch","nl"),e.set("English","en"),e.set("Estonian","et"),e.set("Filipino","fil"),e.set("Finnish","fi"),e.set("French","fr"),e.set("German","el"),e.set("Greek","be"),e.set("Hebrew","he"),e.set("Hindi","hi"),e.set("Hungarian","hu"),e.set("Indonesian","id"),e.set("Italian","it"),e.set("Japanese","ja"),e.set("Korean","ko"),e.set("Latvian","lv"),e.set("Lithuanian","lt"),e.set("Malay","ms"),e.set("Norwegian","no"),e.set("Polish","pl"),e.set("Portuguese_Brazil","pt-br"),e.set("Portuguese_Portugal","pt"),e.set("Romanian","ro"),e.set("Russian","ru"),e.set("Serbian","sr"),e.set("Slovak","sk"),e.set("Slovenian","sl"),e.set("Spanish","es"),e.set("Swahili","sw"),e.set("Thai","th"),e.set("Turkish","tr"),e.set("Ukranian","uk"),e.set("Vietnamese","vi");let t=[];for(let i of e.keys()){let n={name:i,imageSmall:{fileName:i.concat("_S.png")},imageLarge:{fileName:i.concat("_L.png")},imageSmallLight:{fileName:i.concat("_S.png")},imageLargeLight:{fileName:"English_LL.svg"},code:e.get(i)||""};t.push(n)}return t}}e=new WeakMap,t=new WeakMap,i=new WeakMap,n=new WeakMap,a=new WeakMap,o.englishLanguage={name:"English",code:"en",imageSmall:{fileName:"English_S.png"},imageSmallLight:{fileName:"English_L.png"},imageLarge:{fileName:"English_L.png"},imageLargeLight:{fileName:"English_LL.svg"}},o.supportedLanguages=o.createSupportedLanguages(),customElements.define("ms-store-badge",o);
